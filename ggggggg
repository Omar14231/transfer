-- Dual Save & Teleport + Camera Controls
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local player = Players.LocalPlayer

-- أماكن التخزين
local savedPositions1 = {} -- المجموعة 1
local savedPositions2 = {} -- المجموعة 2

-- إعدادات الكاميرا
local camera = workspace.CurrentCamera
local originalCameraType = camera.CameraType
local cameraModes = {
    "Classic",
    "Follow",
    "Attach",
    "Custom",
    "Scriptable"
}

-- دالة إنشاء الأزرار
local function createButtons()
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "AdvancedControlsGUI"
    screenGui.ResetOnSpawn = false

    -- === الإطار الأيمن (أزرار الحفظ) ===
    local rightFrame = Instance.new("Frame")
    rightFrame.Size = UDim2.new(0, 150, 0, 200)
    rightFrame.Position = UDim2.new(1, -160, 0.5, -100) -- يمين الشاشة
    rightFrame.BackgroundColor3 = Color3.fromRGB(30, 40, 50)
    rightFrame.BackgroundTransparency = 0.1
    rightFrame.BorderSizePixel = 0
    rightFrame.Parent = screenGui

    -- عنوان الحفظ
    local saveTitle = Instance.new("TextLabel")
    saveTitle.Size = UDim2.new(0.9, 0, 0, 30)
    saveTitle.Position = UDim2.new(0.05, 0, 0.05, 0)
    saveTitle.Text = "💾 SAVE"
    saveTitle.TextColor3 = Color3.fromRGB(100, 200, 255)
    saveTitle.BackgroundTransparency = 1
    saveTitle.Font = Enum.Font.GothamBold
    saveTitle.TextSize = 18
    saveTitle.Parent = rightFrame

    -- زر حفظ 1
    local saveButton1 = Instance.new("TextButton")
    saveButton1.Size = UDim2.new(0.9, 0, 0, 40)
    saveButton1.Position = UDim2.new(0.05, 0, 0.25, 0)
    saveButton1.Text = "SAVE 1"
    saveButton1.TextColor3 = Color3.fromRGB(255, 255, 255)
    saveButton1.BackgroundColor3 = Color3.fromRGB(70, 130, 200)
    saveButton1.BorderSizePixel = 0
    saveButton1.Font = Enum.Font.GothamBold
    saveButton1.TextSize = 14
    saveButton1.Parent = rightFrame

    -- زر حفظ 2
    local saveButton2 = Instance.new("TextButton")
    saveButton2.Size = UDim2.new(0.9, 0, 0, 40)
    saveButton2.Position = UDim2.new(0.05, 0, 0.55, 0)
    saveButton2.Text = "SAVE 2"
    saveButton2.TextColor3 = Color3.fromRGB(255, 255, 255)
    saveButton2.BackgroundColor3 = Color3.fromRGB(180, 80, 180)
    saveButton2.BorderSizePixel = 0
    saveButton2.Font = Enum.Font.GothamBold
    saveButton2.TextSize = 14
    saveButton2.Parent = rightFrame

    -- === الإطار الأيسر (أزرار الانتقال) ===
    local leftFrame = Instance.new("Frame")
    leftFrame.Size = UDim2.new(0, 150, 0, 200)
    leftFrame.Position = UDim2.new(0, 10, 0.5, -100) -- يسار الشاشة
    leftFrame.BackgroundColor3 = Color3.fromRGB(50, 30, 40)
    leftFrame.BackgroundTransparency = 0.1
    leftFrame.BorderSizePixel = 0
    leftFrame.Parent = screenGui

    -- عنوان الانتقال
    local teleportTitle = Instance.new("TextLabel")
    teleportTitle.Size = UDim2.new(0.9, 0, 0, 30)
    teleportTitle.Position = UDim2.new(0.05, 0, 0.05, 0)
    teleportTitle.Text = "🚀 TELEPORT"
    teleportTitle.TextColor3 = Color3.fromRGB(255, 150, 100)
    teleportTitle.BackgroundTransparency = 1
    teleportTitle.Font = Enum.Font.GothamBold
    teleportTitle.TextSize = 18
    teleportTitle.Parent = leftFrame

    -- زر انتقال 1
    local teleportButton1 = Instance.new("TextButton")
    teleportButton1.Size = UDim2.new(0.9, 0, 0, 40)
    teleportButton1.Position = UDim2.new(0.05, 0, 0.25, 0)
    teleportButton1.Text = "TELEPORT 1"
    teleportButton1.TextColor3 = Color3.fromRGB(255, 255, 255)
    teleportButton1.BackgroundColor3 = Color3.fromRGB(50, 150, 100)
    teleportButton1.BorderSizePixel = 0
    teleportButton1.Font = Enum.Font.GothamBold
    teleportButton1.TextSize = 14
    teleportButton1.Parent = leftFrame

    -- زر انتقال 2
    local teleportButton2 = Instance.new("TextButton")
    teleportButton2.Size = UDim2.new(0.9, 0, 0, 40)
    teleportButton2.Position = UDim2.new(0.05, 0, 0.55, 0)
    teleportButton2.Text = "TELEPORT 2"
    teleportButton2.TextColor3 = Color3.fromRGB(255, 255, 255)
    teleportButton2.BackgroundColor3 = Color3.fromRGB(220, 120, 60)
    teleportButton2.BorderSizePixel = 0
    teleportButton2.Font = Enum.Font.GothamBold
    teleportButton2.TextSize = 14
    teleportButton2.Parent = leftFrame

    -- === إطار تحكم الكاميرا ===
    local cameraFrame = Instance.new("Frame")
    cameraFrame.Size = UDim2.new(0, 180, 0, 150)
    cameraFrame.Position = UDim2.new(0.5, -90, 0, 20) -- أعلى الوسط
    cameraFrame.BackgroundColor3 = Color3.fromRGB(40, 30, 50)
    cameraFrame.BackgroundTransparency = 0.1
    cameraFrame.BorderSizePixel = 0
    cameraFrame.Parent = screenGui

    -- عنوان الكاميرا
    local cameraTitle = Instance.new("TextLabel")
    cameraTitle.Size = UDim2.new(0.9, 0, 0, 25)
    cameraTitle.Position = UDim2.new(0.05, 0, 0.05, 0)
    cameraTitle.Text = "📷 CAMERA CONTROLS"
    cameraTitle.TextColor3 = Color3.fromRGB(200, 200, 100)
    cameraTitle.BackgroundTransparency = 1
    cameraTitle.Font = Enum.Font.GothamBold
    cameraTitle.TextSize = 16
    cameraTitle.Parent = cameraFrame

    -- زر تبديل وضع الكاميرا
    local cameraModeButton = Instance.new("TextButton")
    cameraModeButton.Size = UDim2.new(0.9, 0, 0, 30)
    cameraModeButton.Position = UDim2.new(0.05, 0, 0.3, 0)
    cameraModeButton.Text = "MODE: " .. camera.CameraType
    cameraModeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    cameraModeButton.BackgroundColor3 = Color3.fromRGB(100, 100, 200)
    cameraModeButton.BorderSizePixel = 0
    cameraModeButton.Font = Enum.Font.Gotham
    cameraModeButton.TextSize = 12
    cameraModeButton.Parent = cameraFrame

    -- زر إعادة تعيين الكاميرا
    local resetCameraButton = Instance.new("TextButton")
    resetCameraButton.Size = UDim2.new(0.9, 0, 0, 30)
    resetCameraButton.Position = UDim2.new(0.05, 0, 0.6, 0)
    resetCameraButton.Text = "RESET CAMERA"
    resetCameraButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    resetCameraButton.BackgroundColor3 = Color3.fromRGB(200, 100, 100)
    resetCameraButton.BorderSizePixel = 0
    resetCameraButton.Font = Enum.Font.GothamBold
    resetCameraButton.TextSize = 12
    resetCameraButton.Parent = cameraFrame

    -- دالة تأثيرات الأزرار
    local function setupButtonEffects(button, originalColor)
        button.MouseEnter:Connect(function()
            TweenService:Create(button, TweenInfo.new(0.2), {BackgroundColor3 = originalColor + Color3.new(0.2, 0.2, 0.2)}):Play()
        end)
        button.MouseLeave:Connect(function()
            TweenService:Create(button, TweenInfo.new(0.2), {BackgroundColor3 = originalColor}):Play()
        end)
    end

    -- تطبيق التأثيرات
    setupButtonEffects(saveButton1, Color3.fromRGB(70, 130, 200))
    setupButtonEffects(saveButton2, Color3.fromRGB(180, 80, 180))
    setupButtonEffects(teleportButton1, Color3.fromRGB(50, 150, 100))
    setupButtonEffects(teleportButton2, Color3.fromRGB(220, 120, 60))
    setupButtonEffects(cameraModeButton, Color3.fromRGB(100, 100, 200))
    setupButtonEffects(resetCameraButton, Color3.fromRGB(200, 100, 100))

    -- دالة حفظ الموقع
    local function saveLocation(positionTable, button, setNumber)
        local character = player.Character
        if character and character:FindFirstChild("HumanoidRootPart") then
            local hrp = character.HumanoidRootPart
            local position = hrp.Position
            
            table.insert(positionTable, position)
            print("📍 تم حفظ الموقع في المجموعة " .. setNumber)
            
            button.Text = "✅ SAVED " .. setNumber
            wait(1)
            button.Text = "SAVE " .. setNumber
        else
            print("❌ لا يمكن حفظ الموقع")
        end
    end

    -- دالة الانتقال
    local function teleportToLocation(positionTable, button, setNumber)
        if #positionTable > 0 then
            local character = player.Character
            if character and character:FindFirstChild("HumanoidRootPart") then
                local hrp = character.HumanoidRootPart
                local lastPosition = positionTable[#positionTable]
                
                hrp.CFrame = CFrame.new(lastPosition)
                print("🚀 تم الانتقال إلى المجموعة " .. setNumber)
                
                button.Text = "✅ TP " .. setNumber
                wait(1)
                button.Text = "TELEPORT " .. setNumber
            else
                print("❌ لا يمكن الانتقال")
            end
        else
            print("❌ لا توجد مواقع في المجموعة " .. setNumber)
            button.Text = "❌ NO SAVES"
            wait(1)
            button.Text = "TELEPORT " .. setNumber
        end
    end

    -- أحداث أزرار الحفظ والانتقال
    saveButton1.MouseButton1Click:Connect(function()
        saveLocation(savedPositions1, saveButton1, "1")
    end)

    saveButton2.MouseButton1Click:Connect(function()
        saveLocation(savedPositions2, saveButton2, "2")
    end)

    teleportButton1.MouseButton1Click:Connect(function()
        teleportToLocation(savedPositions1, teleportButton1, "1")
    end)

    teleportButton2.MouseButton1Click:Connect(function()
        teleportToLocation(savedPositions2, teleportButton2, "2")
    end)

    -- أحداث تحكم الكاميرا
    local currentModeIndex = 1
    cameraModeButton.MouseButton1Click:Connect(function()
        currentModeIndex = currentModeIndex + 1
        if currentModeIndex > #cameraModes then
            currentModeIndex = 1
        end
        
        local newMode = cameraModes[currentModeIndex]
        camera.CameraType = Enum.CameraType[newMode]
        cameraModeButton.Text = "MODE: " .. newMode
        
        print("📷 وضع الكاميرا: " .. newMode)
    end)

    resetCameraButton.MouseButton1Click:Connect(function()
        camera.CameraType = originalCameraType
        camera.CameraSubject = player.Character:FindFirstChild("Humanoid")
        cameraModeButton.Text = "MODE: " .. originalCameraType.Name
        
        print("📷 تم إعادة تعيين الكاميرا")
        
        resetCameraButton.Text = "✅ RESET"
        wait(1)
        resetCameraButton.Text = "RESET CAMERA"
    end)

    return screenGui
end

-- تشغيل النظام
local function initSystem()
    repeat wait() until player:FindFirstChild("PlayerGui")
    
    local controlsGUI = createButtons()
    controlsGUI.Parent = player:WaitForChild("PlayerGui")
    
    print("🎮 نظام التحكم المتقدم جاهز!")
    print("💾 يمين: أزرار الحفظ")
    print("🚀 يسار: أزرار الانتقال") 
    print("📷 أعلى: تحكم الكاميرا")
end

-- بدء التشغيل
initSystem()
