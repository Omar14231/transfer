-- Advanced Mobile Chat System with Player Detection
-- By: [Your Name]

local Players = game:GetService("Players")
local PlayerGui = Players.LocalPlayer:WaitForChild("PlayerGui")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")

-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ù…ØµØ±Ø­ Ù„Ù‡Ù…
local AUTHORIZED_PLAYERS = {
    ["hhjjkkllpppp098"] = true
}

-- Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
local chatSystemActive = false
local currentConnection = nil
local connectedPlayer = nil
local waitingForConnection = false

-- ğŸ® Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø´Ø§Øª
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "AdvancedChatSystem"
screenGui.ResetOnSpawn = false
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(1, 0, 1, 0)
mainFrame.BackgroundTransparency = 1
mainFrame.Parent = screenGui

-- Ø²Ø± Ø§Ù„Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±
local chatButton = Instance.new("ImageButton")
chatButton.Name = "ChatButton"
chatButton.Size = UDim2.new(0, 50, 0, 50)
chatButton.Position = UDim2.new(0, 20, 0, 20)
chatButton.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
chatButton.Image = "rbxassetid://" -- Ø£Ø¶Ù ØµÙˆØ±Ø© Ø²Ø± Ø¬Ù…ÙŠÙ„Ø© Ù‡Ù†Ø§
chatButton.ScaleType = Enum.ScaleType.Fit
chatButton.BorderSizePixel = 0
chatButton.Parent = mainFrame

-- Ø¬Ø¹Ù„ Ø§Ù„Ø²Ø± Ø¯Ø§Ø¦Ø±ÙŠ
local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(1, 0)
corner.Parent = chatButton

-- Ø¥Ø·Ø§Ø± Ø§Ù„Ø´Ø§Øª (Ù…Ø®ÙÙŠ ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©)
local chatFrame = Instance.new("Frame")
chatFrame.Name = "ChatFrame"
chatFrame.Size = UDim2.new(0, 300, 0, 400)
chatFrame.Position = UDim2.new(0.5, -150, 0.5, -200)
chatFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
chatFrame.BorderSizePixel = 0
chatFrame.Visible = false
chatFrame.Parent = mainFrame

local chatCorner = Instance.new("UICorner")
chatCorner.CornerRadius = UDim.new(0, 10)
chatCorner.Parent = chatFrame

-- Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
local titleBar = Instance.new("Frame")
titleBar.Size = UDim2.new(1, 0, 0, 30)
titleBar.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
titleBar.Parent = chatFrame

local titleCorner = Instance.new("UICorner")
titleCorner.CornerRadius = UDim.new(0, 10)
titleCorner.Parent = titleBar

local titleLabel = Instance.new("TextLabel")
titleLabel.Size = UDim2.new(1, -60, 1, 0)
titleLabel.Position = UDim2.new(0, 10, 0, 0)
titleLabel.BackgroundTransparency = 1
titleLabel.Text = "Ù†Ø¸Ø§Ù… Ø§Ù„Ø´Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…"
titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
titleLabel.TextXAlignment = Enum.TextXAlignment.Left
titleLabel.Font = Enum.Font.GothamBold
titleLabel.TextSize = 14
titleLabel.Parent = titleBar

-- Ø²Ø± Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ (X)
local closeButton = Instance.new("TextButton")
closeButton.Size = UDim2.new(0, 30, 0, 30)
closeButton.Position = UDim2.new(1, -30, 0, 0)
closeButton.BackgroundColor3 = Color3.fromRGB(255, 60, 60)
closeButton.Text = "X"
closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
closeButton.Font = Enum.Font.GothamBold
closeButton.TextSize = 14
closeButton.Parent = titleBar

local closeCorner = Instance.new("UICorner")
closeCorner.CornerRadius = UDim.new(0, 10)
closeCorner.Parent = closeButton

-- Ø³Ø¬Ù„ Ø§Ù„Ø´Ø§Øª Ù…Ø¹ Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ…Ø±ÙŠØ±
local chatLogScrollingFrame = Instance.new("ScrollingFrame")
chatLogScrollingFrame.Size = UDim2.new(1, -10, 1, -100)
chatLogScrollingFrame.Position = UDim2.new(0, 5, 0, 35)
chatLogScrollingFrame.BackgroundTransparency = 1
chatLogScrollingFrame.BorderSizePixel = 0
chatLogScrollingFrame.ScrollBarThickness = 6
chatLogScrollingFrame.ScrollBarImageColor3 = Color3.fromRGB(100, 100, 100)
chatLogScrollingFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
chatLogScrollingFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y
chatLogScrollingFrame.Parent = chatFrame

local chatLogLayout = Instance.new("UIListLayout")
chatLogLayout.Padding = UDim.new(0, 5)
chatLogLayout.Parent = chatLogScrollingFrame

-- Ø´Ø±ÙŠØ· Ø§Ù„ÙƒØªØ§Ø¨Ø©
local inputFrame = Instance.new("Frame")
inputFrame.Size = UDim2.new(1, -10, 0, 40)
inputFrame.Position = UDim2.new(0, 5, 1, -50)
inputFrame.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
inputFrame.Parent = chatFrame

local inputCorner = Instance.new("UICorner")
inputCorner.CornerRadius = UDim.new(0, 8)
inputCorner.Parent = inputFrame

local textBox = Instance.new("TextBox")
textBox.Size = UDim2.new(1, -80, 1, -10)
textBox.Position = UDim2.new(0, 5, 0, 5)
textBox.BackgroundTransparency = 1
textBox.Text = "Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§..."
textBox.TextColor3 = Color3.fromRGB(200, 200, 200)
textBox.Font = Enum.Font.Gotham
textBox.TextSize = 14
textBox.TextXAlignment = Enum.TextXAlignment.Left
textBox.Parent = inputFrame

local sendButton = Instance.new("TextButton")
sendButton.Size = UDim2.new(0, 60, 1, -10)
sendButton.Position = UDim2.new(1, -65, 0, 5)
sendButton.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
sendButton.Text = "Ø¥Ø±Ø³Ø§Ù„"
sendButton.TextColor3 = Color3.fromRGB(255, 255, 255)
sendButton.Font = Enum.Font.GothamBold
sendButton.TextSize = 12
sendButton.Parent = inputFrame

local sendCorner = Instance.new("UICorner")
sendCorner.CornerRadius = UDim.new(0, 6)
sendCorner.Parent = sendButton

-- Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±
local waitMessage = Instance.new("TextLabel")
waitMessage.Size = UDim2.new(1, -20, 0, 60)
waitMessage.Position = UDim2.new(0, 10, 0.5, -30)
waitMessage.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
waitMessage.Text = "â³ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±...\nÙŠØªÙ… Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù„Ø§Ø¹Ø¨ Ù„Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø´Ø§Øª"
waitMessage.TextColor3 = Color3.fromRGB(255, 255, 255)
waitMessage.Font = Enum.Font.Gotham
waitMessage.TextSize = 14
waitMessage.TextWrapped = true
waitMessage.Visible = false
waitMessage.Parent = chatFrame

local waitCorner = Instance.new("UICorner")
waitCorner.CornerRadius = UDim.new(0, 8)
waitCorner.Parent = waitMessage

-- ğŸ” Ù†Ø¸Ø§Ù… Ø§ÙƒØªØ´Ø§Ù Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†
local function detectAuthorizedPlayers()
    for _, player in pairs(Players:GetPlayers()) do
        if AUTHORIZED_PLAYERS[player.Name] and player ~= Players.LocalPlayer then
            return player
        end
    end
    return nil
end

-- ğŸ”„ Ù†Ø¸Ø§Ù… Ø§Ù„Ø§ØªØµØ§Ù„
local function establishChatConnection()
    if waitingForConnection then return end
    
    waitingForConnection = true
    waitMessage.Visible = true
    
    local detectionAttempts = 0
    local maxAttempts = 10
    
    -- Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø§ÙƒØªØ´Ø§Ù Ù„Ù…Ø¯Ø© 10 Ø«ÙˆØ§Ù†ÙŠ
    local detectionLoop
    detectionLoop = RunService.Heartbeat:Connect(function()
        detectionAttempts += 1
        
        local foundPlayer = detectAuthorizedPlayers()
        if foundPlayer then
            detectionLoop:Disconnect()
            waitingForConnection = false
            waitMessage.Visible = false
            connectedPlayer = foundPlayer
            chatSystemActive = true
            
            -- Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ù†Ø¬Ø§Ø­ Ø§Ù„Ø§ØªØµØ§Ù„
            addMessageToLog("âœ… ØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€: " .. foundPlayer.Name, Color3.fromRGB(0, 255, 0))
            return
        end
        
        if detectionAttempts >= maxAttempts then
            detectionLoop:Disconnect()
            waitingForConnection = false
            waitMessage.Visible = false
            
            -- Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨Ø¯ÙˆÙ† Ø§ØªØµØ§Ù„
            chatSystemActive = true
            addMessageToLog("âš ï¸ Ø§Ù„ØªØ´ØºÙŠÙ„ Ø¨Ø¯ÙˆÙ† Ø§ØªØµØ§Ù„", Color3.fromRGB(255, 255, 0))
        end
    end)
end

-- âœ‰ï¸ Ø¥Ø¶Ø§ÙØ© Ø±Ø³Ø§Ù„Ø© Ù„Ù„Ø³Ø¬Ù„
local function addMessageToLog(message, color)
    local messageFrame = Instance.new("Frame")
    messageFrame.Size = UDim2.new(1, 0, 0, 0)
    messageFrame.BackgroundTransparency = 1
    messageFrame.AutomaticSize = Enum.AutomaticSize.Y
    messageFrame.Parent = chatLogScrollingFrame
    
    local messageLabel = Instance.new("TextLabel")
    messageLabel.Size = UDim2.new(1, 0, 0, 0)
    messageLabel.BackgroundTransparency = 1
    messageLabel.Text = message
    messageLabel.TextColor3 = color or Color3.fromRGB(255, 255, 255)
    messageLabel.Font = Enum.Font.Gotham
    messageLabel.TextSize = 12
    messageLabel.TextWrapped = true
    messageLabel.AutomaticSize = Enum.AutomaticSize.Y
    messageLabel.TextXAlignment = Enum.TextXAlignment.Left
    messageLabel.Parent = messageFrame
    
    -- Ø§Ù„ØªÙ…Ø±ÙŠØ± Ù„Ù„Ø£Ø³ÙÙ„
    wait()
    chatLogScrollingFrame.CanvasPosition = Vector2.new(0, chatLogScrollingFrame.AbsoluteCanvasSize.Y)
end

-- ğŸˆ Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ù„Ø© ÙÙˆÙ‚ Ø§Ù„Ø±Ø£Ø³
local function displayMessageAboveHead(message, player)
    local character = player.Character
    if not character then return end
    
    local head = character:FindFirstChild("Head")
    if not head then return end
    
    local billboardGui = Instance.new("BillboardGui")
    billboardGui.Size = UDim2.new(0, 200, 0, 50)
    billboardGui.StudsOffset = Vector3.new(0, 3, 0)
    billboardGui.Adornee = head
    billboardGui.Parent = head
    
    local textLabel = Instance.new("TextLabel")
    textLabel.Size = UDim2.new(1, 0, 1, 0)
    textLabel.BackgroundTransparency = 1
    textLabel.Text = message
    textLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    textLabel.Font = Enum.Font.GothamBold
    textLabel.TextSize = 14
    textLabel.TextStrokeTransparency = 0
    textLabel.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
    textLabel.Parent = billboardGui
    
    -- Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¨Ø¹Ø¯ 15 Ø«Ø§Ù†ÙŠØ©
    delay(15, function()
        if billboardGui then
            billboardGui:Destroy()
        end
    end)
end

-- ğŸ“¤ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
local function sendMessage()
    local message = textBox.Text
    if message == "" or message == "Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§..." then return end
    
    -- Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù„Ù„Ø³Ø¬Ù„ Ø§Ù„Ù…Ø­Ù„ÙŠ
    addMessageToLog(Players.LocalPlayer.Name .. ": " .. message, Color3.fromRGB(0, 170, 255))
    
    -- Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ù„Ø© ÙÙˆÙ‚ Ø±Ø£Ø³ Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ù…Ø­Ù„ÙŠ
    displayMessageAboveHead(message, Players.LocalPlayer)
    
    -- Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ù…ØªØµÙ„ (Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ØªØµÙ„Ø§Ù‹)
    if connectedPlayer then
        -- Ù‡Ù†Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© Ù†Ø¸Ø§Ù… Ø§Ù„Ø´Ø¨ÙƒØ© Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø¢Ø®Ø±
        addMessageToLog("ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù„Ù€ " .. connectedPlayer.Name, Color3.fromRGB(0, 255, 170))
        
        -- Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ù„Ø© ÙÙˆÙ‚ Ø±Ø£Ø³ Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ù…ØªØµÙ„
        displayMessageAboveHead(message, connectedPlayer)
    end
    
    -- Ù…Ø³Ø­ ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù†Øµ
    textBox.Text = ""
end

-- ğŸ¯ Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø£Ø²Ø±Ø§Ø±
chatButton.MouseButton1Click:Connect(function()
    if not chatSystemActive then
        establishChatConnection()
    end
    chatFrame.Visible = true
end)

closeButton.MouseButton1Click:Connect(function()
    chatFrame.Visible = false
end)

sendButton.MouseButton1Click:Connect(function()
    sendMessage()
end)

textBox.Focused:Connect(function()
    if textBox.Text == "Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§..." then
        textBox.Text = ""
        textBox.TextColor3 = Color3.fromRGB(255, 255, 255)
    end
end)

textBox.FocusLost:Connect(function()
    if textBox.Text == "" then
        textBox.Text = "Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§..."
        textBox.TextColor3 = Color3.fromRGB(200, 200, 200)
    end
end)

-- ğŸ” Ù…Ø±Ø§Ù‚Ø¨Ø© Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ø¬Ø¯Ø¯
Players.PlayerAdded:Connect(function(player)
    if AUTHORIZED_PLAYERS[player.Name] and chatSystemActive then
        addMessageToLog("ğŸ¯ " .. player.Name .. " Ø¯Ø®Ù„ Ø§Ù„Ù„Ø¹Ø¨Ø©", Color3.fromRGB(255, 255, 0))
        
        if not connectedPlayer then
            connectedPlayer = player
            addMessageToLog("âœ… ØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹", Color3.fromRGB(0, 255, 0))
        end
    end
end)

-- ğŸ® Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
screenGui.Parent = PlayerGui

-- ğŸ“¢ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¨Ø¯Ø¡
print("ğŸ® Ù†Ø¸Ø§Ù… Ø§Ù„Ø´Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù… Ø¬Ø§Ù‡Ø²!")
print("ğŸ” ÙŠØ¨Ø­Ø« Ø¹Ù†: Jahdh")
print("âœ… Ø§Ù„Ù†Ø¸Ø§Ù… Ø³ÙŠØ¹Ù…Ù„ Ø­ØªÙ‰ Ø¨Ø¯ÙˆÙ† Ø§ØªØµØ§Ù„")

-- Ø¥Ø¶Ø§ÙØ© Ø±Ø³Ø§Ù„Ø© ØªØ±Ø­ÙŠØ¨
delay(2, function()
    addMessageToLog("Ù…Ø±Ø­Ø¨Ø§Ù‹! Ù†Ø¸Ø§Ù… Ø§Ù„Ø´Ø§Øª Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…", Color3.fromRGB(255, 255, 255))
end)
