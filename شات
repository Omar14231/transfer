-- Secure Private Chat System - FINAL VERSION
-- By: [Your Name]

local Players = game:GetService("Players")
local PlayerGui = Players.LocalPlayer:WaitForChild("PlayerGui")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")

-- ğŸ”’ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ù…ØµØ±Ø­ Ù„Ù‡Ù…
local AUTHORIZED_PLAYERS = {
    ["Player1"] = true  -- ØºÙŠØ± Ø§Ù„Ø§Ø³Ù… Ø­Ø³Ø¨ Ø§Ø­ØªÙŠØ§Ø¬Ùƒ
}

-- Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
local chatSystemActive = false
local connectedPlayer = nil

-- ğŸ® Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø´Ø§Øª Ù…Ø¹ ØªØ«Ø¨ÙŠØª
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "SecureChatSystem"
screenGui.ResetOnSpawn = false
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(1, 0, 1, 0)
mainFrame.BackgroundTransparency = 1
mainFrame.Parent = screenGui

-- ğŸ¯ Ø§Ù„Ø²Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø¶Ø§Ù - Ø²Ø± Ø§Ù„Ø´Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
local chatButton = Instance.new("ImageButton")
chatButton.Name = "MainChatButton"
chatButton.Size = UDim2.new(0, 70, 0, 70) -- Ø­Ø¬Ù… Ø£ÙƒØ¨Ø± Ù‚Ù„ÙŠÙ„Ø§Ù‹
chatButton.Position = UDim2.new(0, 25, 0.8, -35) -- Ø£Ø³ÙÙ„ Ø§Ù„ÙŠØ³Ø§Ø±
chatButton.BackgroundColor3 = Color3.fromRGB(0, 150, 255)
chatButton.Image = "rbxassetid://" -- Ø£Ø¶Ù ØµÙˆØ±Ø© Ø²Ø± Ø¬Ù…ÙŠÙ„Ø© Ù‡Ù†Ø§
chatButton.ScaleType = Enum.ScaleType.Fit
chatButton.BorderSizePixel = 0
chatButton.Parent = mainFrame

-- Ø¬Ø¹Ù„ Ø§Ù„Ø²Ø± Ø¯Ø§Ø¦Ø±ÙŠ Ù…Ø¹ Ø¸Ù„
local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(1, 0)
corner.Parent = chatButton

local shadow = Instance.new("UIStroke")
shadow.Color = Color3.fromRGB(0, 100, 200)
shadow.Thickness = 3
shadow.Parent = chatButton

-- ØªØ£Ø«ÙŠØ± Ø§Ù„ØªÙˆÙ‡Ø¬ Ø¹Ù†Ø¯ Ø§Ù„ØªÙ…Ø±ÙŠØ±
chatButton.MouseEnter:Connect(function()
    TweenService:Create(chatButton, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(0, 170, 255)}):Play()
end)

chatButton.MouseLeave:Connect(function()
    TweenService:Create(chatButton, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(0, 150, 255)}):Play()
end)

-- Ø¥Ø·Ø§Ø± Ø§Ù„Ø´Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (Ù…Ø«Ø¨Øª Ø¨Ø´ÙƒÙ„ Ø¢Ù…Ù†)
local chatFrame = Instance.new("Frame")
chatFrame.Name = "ChatFrame"
chatFrame.Size = UDim2.new(0, 350, 0, 450)
chatFrame.Position = UDim2.new(0.5, -175, 0.5, -225) -- Ù…Ù†ØªØµÙ Ø§Ù„Ø´Ø§Ø´Ø©
chatFrame.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
chatFrame.BorderSizePixel = 0
chatFrame.Visible = false
chatFrame.Parent = mainFrame
chatFrame.ClipsDescendants = true

local chatCorner = Instance.new("UICorner")
chatCorner.CornerRadius = UDim.new(0, 15)
chatCorner.Parent = chatFrame

-- Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
local titleBar = Instance.new("Frame")
titleBar.Size = UDim2.new(1, 0, 0, 40)
titleBar.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
titleBar.Parent = chatFrame

local titleCorner = Instance.new("UICorner")
titleCorner.CornerRadius = UDim.new(0, 15)
titleCorner.Parent = titleBar

local titleLabel = Instance.new("TextLabel")
titleLabel.Size = UDim2.new(1, -50, 1, 0)
titleLabel.Position = UDim2.new(0, 15, 0, 0)
titleLabel.BackgroundTransparency = 1
titleLabel.Text = "ğŸ’¬ Ø§Ù„Ø´Ø§Øª Ø§Ù„Ø³Ø±ÙŠ"
titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
titleLabel.TextXAlignment = Enum.TextXAlignment.Left
titleLabel.Font = Enum.Font.GothamBold
titleLabel.TextSize = 16
titleLabel.Parent = titleBar

-- Ø²Ø± Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ (X)
local closeButton = Instance.new("TextButton")
closeButton.Size = UDim2.new(0, 30, 0, 30)
closeButton.Position = UDim2.new(1, -35, 0, 5)
closeButton.BackgroundColor3 = Color3.fromRGB(255, 80, 80)
closeButton.Text = "X"
closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
closeButton.Font = Enum.Font.GothamBold
closeButton.TextSize = 14
closeButton.Parent = titleBar

local closeCorner = Instance.new("UICorner")
closeCorner.CornerRadius = UDim.new(1, 0)
closeCorner.Parent = closeButton

-- Ù…Ù†Ø·Ù‚Ø© Ø³Ø¬Ù„ Ø§Ù„Ø´Ø§Øª (Ù…Ø«Ø¨ØªØ© Ø¨Ø´ÙƒÙ„ Ø¢Ù…Ù†)
local chatLogScrollingFrame = Instance.new("ScrollingFrame")
chatLogScrollingFrame.Size = UDim2.new(1, -10, 1, -120)
chatLogScrollingFrame.Position = UDim2.new(0, 5, 0, 45)
chatLogScrollingFrame.BackgroundTransparency = 1
chatLogScrollingFrame.BorderSizePixel = 0
chatLogScrollingFrame.ScrollBarThickness = 8
chatLogScrollingFrame.ScrollBarImageColor3 = Color3.fromRGB(100, 100, 100)
chatLogScrollingFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
chatLogScrollingFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y
chatLogScrollingFrame.Parent = chatFrame

local chatLogLayout = Instance.new("UIListLayout")
chatLogLayout.Padding = UDim.new(0, 8)
chatLogLayout.Parent = chatLogScrollingFrame

-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ù…Ø«Ø¨ØªØ© ÙÙŠ Ø§Ù„Ø£Ø³ÙÙ„ Ø¨Ø´ÙƒÙ„ Ø¢Ù…Ù†)
local inputFrame = Instance.new("Frame")
inputFrame.Size = UDim2.new(1, -20, 0, 50)
inputFrame.Position = UDim2.new(0, 10, 1, -65)
inputFrame.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
inputFrame.Parent = chatFrame
inputFrame.ClipsDescendants = true

local inputCorner = Instance.new("UICorner")
inputCorner.CornerRadius = UDim.new(0, 10)
inputCorner.Parent = inputFrame

local textBox = Instance.new("TextBox")
textBox.Size = UDim2.new(1, -80, 1, -10)
textBox.Position = UDim2.new(0, 10, 0, 5)
textBox.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
textBox.TextColor3 = Color3.fromRGB(255, 255, 255)
textBox.PlaceholderText = "Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§..."
textBox.PlaceholderColor3 = Color3.fromRGB(180, 180, 180)
textBox.Font = Enum.Font.Gotham
textBox.TextSize = 14
textBox.TextXAlignment = Enum.TextXAlignment.Left
textBox.ClearTextOnFocus = false
textBox.Parent = inputFrame

local textBoxCorner = Instance.new("UICorner")
textBoxCorner.CornerRadius = UDim.new(0, 8)
textBoxCorner.Parent = textBox

local sendButton = Instance.new("TextButton")
sendButton.Size = UDim2.new(0, 60, 1, -10)
sendButton.Position = UDim2.new(1, -65, 0, 5)
sendButton.BackgroundColor3 = Color3.fromRGB(0, 200, 100)
sendButton.Text = "ğŸ•Šï¸ Ø¥Ø±Ø³Ø§Ù„"
sendButton.TextColor3 = Color3.fromRGB(255, 255, 255)
sendButton.Font = Enum.Font.GothamBold
sendButton.TextSize = 12
sendButton.Parent = inputFrame

local sendCorner = Instance.new("UICorner")
sendCorner.CornerRadius = UDim.new(0, 8)
sendCorner.Parent = sendButton

-- ğŸ”§ Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ«Ø¨ÙŠØª ÙˆØ§Ù„Ø­Ù…Ø§ÙŠØ©
local function ensureUI Safety()
    -- Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø¹Ù†Ø§ØµØ± ÙÙŠ Ø£Ù…Ø§ÙƒÙ†Ù‡Ø§ Ø§Ù„ØµØ­ÙŠØ­Ø©
    chatFrame.Position = UDim2.new(0.5, -175, 0.5, -225)
    chatButton.Position = UDim2.new(0, 25, 0.8, -35)
    
    -- Ù…Ù†Ø¹ ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ÙˆØ¯
    chatFrame.ClipsDescendants = true
    inputFrame.ClipsDescendants = true
end

-- âœ‰ï¸ Ø¥Ø¶Ø§ÙØ© Ø±Ø³Ø§Ù„Ø© Ù„Ù„Ø³Ø¬Ù„ Ù…Ø¹ Ø§Ø³Ù… Ø§Ù„Ù…Ø±Ø³Ù„
local function addMessageToLog(senderName, message, isIncoming)
    local messageFrame = Instance.new("Frame")
    messageFrame.Size = UDim2.new(1, 0, 0, 0)
    messageFrame.BackgroundTransparency = 1
    messageFrame.AutomaticSize = Enum.AutomaticSize.Y
    messageFrame.Parent = chatLogScrollingFrame
    
    local messageBubble = Instance.new("Frame")
    messageBubble.Size = UDim2.new(0.8, 0, 0, 0)
    messageBubble.BackgroundColor3 = isIncoming and Color3.fromRGB(60, 60, 80) or Color3.fromRGB(0, 100, 200)
    messageBubble.AutomaticSize = Enum.AutomaticSize.Y
    messageBubble.Position = isIncoming and UDim2.new(0, 5, 0, 0) or UDim2.new(1, -5, 0, 0)
    messageBubble.AnchorPoint = isIncoming and Vector2.new(0, 0) or Vector2.new(1, 0)
    messageBubble.Parent = messageFrame
    
    local bubbleCorner = Instance.new("UICorner")
    bubbleCorner.CornerRadius = UDim.new(0, 12)
    bubbleCorner.Parent = messageBubble

    local senderLabel = Instance.new("TextLabel")
    senderLabel.Size = UDim2.new(1, -10, 0, 20)
    senderLabel.Position = UDim2.new(0, 5, 0, 2)
    senderLabel.BackgroundTransparency = 1
    senderLabel.Text = senderName
    senderLabel.TextColor3 = Color3.fromRGB(255, 255, 150)
    senderLabel.Font = Enum.Font.GothamBold
    senderLabel.TextSize = 11
    senderLabel.TextXAlignment = Enum.TextXAlignment.Left
    senderLabel.Parent = messageBubble
    
    local messageLabel = Instance.new("TextLabel")
    messageLabel.Size = UDim2.new(1, -10, 0, 0)
    messageLabel.Position = UDim2.new(0, 5, 0, 22)
    messageLabel.BackgroundTransparency = 1
    messageLabel.Text = message
    messageLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    messageLabel.Font = Enum.Font.Gotham
    messageLabel.TextSize = 13
    messageLabel.TextWrapped = true
    messageLabel.AutomaticSize = Enum.AutomaticSize.Y
    messageLabel.TextXAlignment = Enum.TextXAlignment.Left
    messageLabel.Parent = messageBubble
    
    -- Ø§Ù„ØªÙ…Ø±ÙŠØ± Ù„Ù„Ø£Ø³ÙÙ„
    wait(0.1)
    chatLogScrollingFrame.CanvasPosition = Vector2.new(0, chatLogScrollingFrame.AbsoluteCanvasSize.Y)
end

-- ğŸˆ Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ù„Ø© ÙÙˆÙ‚ Ø§Ù„Ø±Ø£Ø³ Ù…Ø¹ Ø§Ø³Ù… Ø§Ù„Ù…Ø±Ø³Ù„
local function displayMessageWithSender(message, senderName, targetPlayer)
    local character = targetPlayer.Character
    if not character then return end
    
    local head = character:FindFirstChild("Head")
    if not head then return end
    
    local billboardGui = Instance.new("BillboardGui")
    billboardGui.Size = UDim2.new(0, 400, 0, 100)
    billboardGui.StudsOffset = Vector3.new(0, 4, 0)
    billboardGui.Adornee = head
    billboardGui.Parent = head
    billboardGui.AlwaysOnTop = true
    
    local background = Instance.new("Frame")
    background.Size = UDim2.new(1, 0, 1, 0)
    background.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    background.BackgroundTransparency = 0.2
    background.Parent = billboardGui
    
    local bgCorner = Instance.new("UICorner")
    bgCorner.CornerRadius = UDim.new(0, 20)
    bgCorner.Parent = background
    
    -- Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ ÙÙŠ Ø§Ù„Ø£Ø¹Ù„Ù‰
    local emojiLabel = Instance.new("TextLabel")
    emojiLabel.Size = UDim2.new(0, 40, 0, 40)
    emojiLabel.Position = UDim2.new(0.5, -20, 0, 5)
    emojiLabel.BackgroundTransparency = 1
    emojiLabel.Text = "ğŸ—¨ï¸"
    emojiLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    emojiLabel.Font = Enum.Font.GothamBold
    emojiLabel.TextSize = 24
    emojiLabel.Parent = billboardGui
    
    -- Ø§Ø³Ù… Ø§Ù„Ù…Ø±Ø³Ù„
    local senderText = Instance.new("TextLabel")
    senderText.Size = UDim2.new(1, -10, 0, 20)
    senderText.Position = UDim2.new(0, 5, 0, 45)
    senderText.BackgroundTransparency = 1
    senderText.Text = "Ù…Ù†: " .. senderName
    senderText.TextColor3 = Color3.fromRGB(255, 255, 150)
    senderText.Font = Enum.Font.GothamBold
    senderText.TextSize = 12
    senderText.Parent = billboardGui
    
    -- Ø§Ù„Ø±Ø³Ø§Ù„Ø©
    local messageText = Instance.new("TextLabel")
    messageText.Size = UDim2.new(1, -10, 0, 30)
    messageText.Position = UDim2.new(0, 5, 0, 65)
    messageText.BackgroundTransparency = 1
    messageText.Text = message
    messageText.TextColor3 = Color3.fromRGB(255, 255, 255)
    messageText.Font = Enum.Font.Gotham
    messageText.TextSize = 14
    messageText.TextWrapped = true
    messageText.Parent = billboardGui
    
    -- Ø¥Ø®ÙØ§Ø¡ Ø¨Ø¹Ø¯ 15 Ø«Ø§Ù†ÙŠØ©
    delay(15, function()
        if billboardGui then
            billboardGui:Destroy()
        end
    end)
end

-- ğŸ“¤ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ
local function sendFinalMessage()
    local message = textBox.Text
    if message == "" or message == "Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§..." then return end
    
    -- Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø´Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠ
    addMessageToLog(Players.LocalPlayer.Name, message, false)
    
    -- Ø¹Ø±Ø¶ ÙÙˆÙ‚ Ø±Ø£Ø³ Ø§Ù„Ù…Ø±Ø³Ù„
    displayMessageWithSender(message, Players.LocalPlayer.Name, Players.LocalPlayer)
    
    -- Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ø¬Ù…ÙŠØ¹
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= Players.LocalPlayer then
            pcall(function()
                displayMessageWithSender(message, Players.LocalPlayer.Name, player)
            end)
        end
    end
    
    addMessageToLog("Ø§Ù„Ù†Ø¸Ø§Ù…", "ğŸ“¢ ØªÙ… Ø¨Ø« Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù„Ù„Ø¬Ù…ÙŠØ¹", false)
    textBox.Text = ""
end

-- ğŸ¯ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© - Ø§Ù„Ø²Ø± Ø§Ù„Ù…Ø¶Ø§Ù
chatButton.MouseButton1Click:Connect(function()
    chatFrame.Visible = not chatFrame.Visible
    ensureUI Safety()
    
    if not chatSystemActive then
        chatSystemActive = true
        addMessageToLog("Ø§Ù„Ù†Ø¸Ø§Ù…", "ğŸ”’ Ø§Ù„Ø´Ø§Øª Ø§Ù„Ø³Ø±ÙŠ Ù…ÙØ¹Ù„ - ÙŠÙ…ÙƒÙ†ÙƒÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ø¦Ù„ ÙˆÙ‚Ø±Ø§Ø¡ØªÙ‡Ø§", false)
        addMessageToLog("Ø§Ù„Ù†Ø¸Ø§Ù…", "ğŸ‘¥ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ø§Ù„Ù†Ø´Ø·ÙˆÙ†: " .. Players.LocalPlayer.Name, false)
    end
end)

closeButton.MouseButton1Click:Connect(function()
    chatFrame.Visible = false
end)

sendButton.MouseButton1Click:Connect(function()
    sendFinalMessage()
end)

textBox.FocusLost:Connect(function(enterPressed)
    if enterPressed then
        sendFinalMessage()
    end
end)

-- ğŸ›¡ï¸ Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ù…Ù† Ø§Ù„Ø¥ØºÙ„Ø§Ù‚
local function antiShutdownSystem()
    while true do
        wait(10)
        ensureUI Safety()
        
        -- Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø¥Ø°Ø§ Ø§Ø®ØªÙØª
        if not screenGui.Parent then
            screenGui.Parent = PlayerGui
        end
    end
end

-- ğŸš€ Ø§Ù„Ø¨Ø¯Ø¡
ensureUI Safety()
screenGui.Parent = PlayerGui
spawn(antiShutdownSystem)

-- ğŸ“¢ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¨Ø¯Ø¡
print("ğŸ¯ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø³Ø±ÙŠ Ù…Ø¹ Ø§Ù„Ø²Ø± Ø§Ù„Ù…Ø¶Ø§Ù ÙŠØ¹Ù…Ù„!")
addMessageToLog("Ø§Ù„Ù†Ø¸Ø§Ù…", "Ù…Ø±Ø­Ø¨Ø§Ù‹ " .. Players.LocalPlayer.Name .. "! Ø§Ù„Ø´Ø§Øª Ø§Ù„Ø³Ø±ÙŠ Ø¬Ø§Ù‡Ø²", false)
addMessageToLog("Ø§Ù„Ù†Ø¸Ø§Ù…", "ÙŠÙ…ÙƒÙ†ÙƒÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ø¦Ù„ ÙˆÙ‚Ø±Ø§Ø¡ØªÙ‡Ø§ Ø¨Ø£Ù…Ø§Ù†", false)
